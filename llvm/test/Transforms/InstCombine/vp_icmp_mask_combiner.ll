; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt < %s -passes=instcombine -S | FileCheck %s

define <vscale x 2 x i1> @test_exp_trunc_mask_combiner(<vscale x 2 x i1> %mask, i32 %evl) {
; CHECK-LABEL: @test_exp_trunc_mask_combiner(
; CHECK-NEXT:    ret <vscale x 2 x i1> [[MASK:%.*]]
;
  %one = insertelement <vscale x 2 x i1> poison, i1 1, i32 0
  %allones = shufflevector <vscale x 2 x i1> %one, <vscale x 2 x i1> poison, <vscale x 2 x i32> zeroinitializer
  %vp.zext = call <vscale x 2 x i32> @llvm.vp.zext.nxv2i32.nxv2i1(<vscale x 2 x i1> %mask, <vscale x 2 x i1> %allones, i32 %evl)
  %vp.icmp = call <vscale x 2 x i1> @llvm.vp.icmp.nxv2i32(<vscale x 2 x i32> %vp.zext, <vscale x 2 x i32> zeroinitializer, metadata !"ne", <vscale x 2 x i1> %allones, i32 %evl)
  ret <vscale x 2 x i1> %vp.icmp
}

declare <vscale x 2 x i32> @llvm.vp.zext.nxv2i32.nxv2i1(<vscale x 2 x i1>, <vscale x 2 x i1>, i32)
declare <vscale x 2 x i1> @llvm.vp.icmp.nxv2i32(<vscale x 2 x i32>, <vscale x 2 x i32>, metadata, <vscale x 2 x i1>, i32)
